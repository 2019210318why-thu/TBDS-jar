# 告警

## 1.介绍

**告警**提供了对集群内的监控数据以及服务有异常时的告警功能。告警分为**指标告警**和**服务告警**，**指标告警**可以对监控页面中的指标创建自定义告警，**服务告警**则是套件内组件运行异常时会自动触发的告警，在套件安装时已经创建，无需手工干预。

## 2.使用

### 2.1入口

套件首页点击**运维中心**卡片，并一次点击进入上侧的**监控告警**、左侧边栏的**告警**图标，即可进入告警页面。

![](../../.gitbook/assets/告警入口.png)

![](../../.gitbook/assets/告警入口2.png)

**注意**：如果找不到入口则是权限不足，请使用具有**Administrator**角色权限的账户登录。

### 2.2指标告警

告警首页默认呈现的即**指标告警**页面。指标告警根据**监控**页面中定义的指标创建相应告警。

#### 2.2.1创建指标告警

点击【`创建告警`】按钮，在弹出的**创建告警**对话框中，依次选择或填入内容即可创建相应指标报警。

![](../../.gitbook/assets/创建指标告警.png)

* _告警名称_：必填，输入的名称最好能够表征相应告警的内容，如创建tbds-10-254-83-16机器CPU1的1分钟平均负载，则可以命名为_tbds-10-254-83-16\_CPU1\_1分钟平均负载_。
* _是否开启_：告警是否开启的开关。在某些情况下想暂时关闭告警则可以把该选项置为关闭状态。
* _通知方式_：复选项，定义告警时的通知方式。每次告警同时还会发站内信给接收人。
* _接收人_：告警的汇报对象。
* _指标分类_：必选项，告警的具体指标名称。
  * _全部服务_：指标的分类列表，与**监控**页面的监控指标分类一致。选择某一分类后旁边的下拉框可选择具体的指标名称。
  * _指标名称_：某一指标分类中的指标名称列表，与**监控**页面的监控指标分类一致。
  * _指标维度_：某些指标具有额外的指标维度，比如当选择**硬件指标**分类中的**内存使用\_总量**指标时，下方会出现**指标维度**选项。在第一个下拉框中选择**host\_name**维度，在第二个下拉框中选择具体的指标维度值，如**tbds-10-254-83-16**，选择**\***表示全选（全选功能在套件4.0.4.1及以后的版本中可用）。指标是否具有指标维度与指标的定义有关，指标定义在监控页面。

    ![](../../.gitbook/assets/指标分类及指标维度.png)
* _告警条件_：分为阈值、同比、环比三种方式。
  * _阈值_：设定告警触发的数值。
  * _同比_：与上一天同一时刻相比增长的百分比（可以为负数）。
  * _环比_：与上一指标检测周期相比增长的百分比（可以为负数）。 对于上面每一种方式，可以分别定义**区间外**、**小于**、**大于**三种告警方式。

    ![](../../.gitbook/assets/告警条件.png)
* _检测周期_：检查告警指标的时间间隔，默认为1分钟，即每1分钟就会去检查定义的告警是否符合触发条件。

#### 2.2.2指标告警的查询、过滤和列表展示

指标告警首页列出了所创建的指标告警及其当前状态，用户可在搜索框中输入**告警名称**或**指标名称**进行模糊查询，也可使用**指标状态**和**指标分类**下拉框进行过滤。

![](../../.gitbook/assets/指标告警列表及查询过滤.png)

#### 2.2.3指标告警的删除、修改和开启、关闭

在指标告警首页可以对列出的告警进行编辑和删除，并可选择关闭或开启其告警，如下图所示。

![](../../.gitbook/assets/指标告警的修改删除.png)

#### 2.2.4指标告警记录

告警首页点击【`告警记录`】按钮可进入**告警记录**页面，在该页面可以根据时间范围、告警接收人和指标名称进行搜索，也可使用**指标分类**下拉框进行过滤。

![](../../.gitbook/assets/告警记录.png)

告警记录也可在在套件的**站内信**中查看。

### 2.3服务告警

在告警首页右上侧点击【`服务告警`】即进入**服务告警**页面。服务告警是在套件组件安装时预定义好的，无法修改，主要针对套件各个组件的运行状态。

#### 2.3.1服务告警的查询、过滤和列表展示

服务告警首页列出了所创建的服务告警及其当前状态，用户可在搜索框中输入**告警名称**或**服务名称**进行模糊查询，也可使用**指标状态**和**指标分类**下拉框进行过滤。

![](../../.gitbook/assets/服务告警列表及查询过滤.png)

#### 2.3.2服务告警的修改和开启、关闭

在服务告警首页可以对列出的告警进行编辑，并可选择关闭或开启其告警，如下图所示。

![](../../.gitbook/assets/服务告警的修改删除.png)

#### 2.3.3服务告警记录

参考**2.2.4指标告警记录\*\***服务告警记录**和**指标告警记录\*\*页面是同一个，服务告警记录也可在在站内信中查看。

### 2.4告警通知的发送策略

某一告警被触发后，为防止连续不断的发送大量重复告警，告警信息的发送间隔是和检测周期成倍数关系增长的，如检测周期是1分钟，则触发告警后会在第1分钟，第1_2分钟，第1_2\*2分钟...发送告警通知。

### 2.5告警的消除策略

某一告警被触发后，只有在连续两个检测周期都发现告警不符合触发条件后才会解除告警状态。

